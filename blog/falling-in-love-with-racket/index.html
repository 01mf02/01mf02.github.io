<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Falling in Love with Racket - gedenkt.at</title>

    <link rel="icon" type="image/png" href="../../media/gedenkt_small.png">
    <link rel="stylesheet" type="text/css" href="../../css/default.css">
    <link rel="stylesheet" type="text/css" href="../../css/syntax.css">
  </head>
  <body>
    <div id="header">
      <div id="logo">
        <a href="../../"><img src="../../media/gedenkt_small.png" /></a>
      </div>
      <div id="navigation">
        <a href="../../">Initium</a>
        <a href="../../erasmus">Erasmus</a>
        <a href="../../musica">Musica</a>
        <a href="../../blog">Blog</a>
      </div>
    </div>

    <div id="content">
      <h1>Falling in Love with Racket</h1>

      <img src="../../media/gedenkt.png" style="float: right; margin: 10px;" />

<div class="info">
    Geschrieben am 07. Jänner 2017
    
</div>

<p>In the last days, I discovered the <a href="http://racket-lang.org/">Racket programming language</a> following <a href="https://lexi-lambda.github.io/blog/2017/01/02/rascal-a-haskell-with-more-parentheses/">a blog post of Alexis King</a>.</p>
<p>My interest was further sparked as I discovered the online books of Matthew Butterick, namely <a href="http://practicaltypography.com/">Practical Typography</a> and <a href="http://beautifulracket.com/">Beautiful Racket</a>. The case he makes for Racket is that can be used as a framework to define new languages, which is significantly easier than in other languages, and that programs in the newly defined languages enjoy immediate support from the Racket tooling.</p>
<p>For example, I was able to create a slideshow in one hour in a Racket-based language using the amazing DrRacket IDE. The slideshow shows an animation and displays a plot:</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">#lang slideshow

(require slideshow/code)
(require slideshow/play)
(require plot)

 (play-n
 (<span class="kw">lambda</span> (n1 n2 n3)
   (vl-append
   (cellophane (t <span class="st">&quot;Hello&quot;</span>)
               (* n1 (<span class="kw">-</span> <span class="fl">1.0</span> n2)))
   (rectangle (* <span class="dv">10</span> n1) (* <span class="dv">10</span> n1))
   (arrow (* <span class="dv">30</span> n2) <span class="dv">0</span>)
   (circle (* <span class="dv">10</span> n3))
   )
   )
 )

(slide
 (plot-pict (function sqr -<span class="dv">1</span> <span class="dv">1</span> #:label <span class="st">&quot;y = x^2&quot;</span>)))</code></pre></div>
<p>Making even just the animation in the Haskell counterpart, <a href="http://projects.haskell.org/diagrams/">Diagrams</a>, is an endeavour that would probably have required me multitudes of the time I took for this. (And boy, did I try making graphics/animations with Diagrams.)</p>
<p>In contrast to the most other Lisp descendants, Racket also has the most attractive website, which makes its community appear vibrant. Did I also mention that the <a href="http://docs.racket-lang.org/">Racket documentation</a> is awesome? Like, the best I’ve ever seen?</p>
<p>While slowly getting hooked, I watched some talks from RacketCon, namely one from Matthew Butterick about his publishing system <a href="http://pollenpub.com/">Pollen</a>, and one by a certain John Clements about functional sound generation:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=IMz09jYOgoc">Matthew Butterick — Like a Blind Squirrel in a Ferrari</a></li>
<li><a href="https://www.youtube.com/watch?v=DkIVzHNjNEA">John Clements — Sound: why is it so darn imperative?</a></li>
</ul>
<p>Both talks were very exciting. I also noted a certain high level of literacy in nearly all of the Racket talks/prose – is this an indication that Lisp programmers have a certain affinity to good writing? (Another good example of this is <a href="http://www.paulgraham.com/">Paul Graham</a>. Just opened the website, read an interesting article about how Pittsburgh could become a city attracting startups, and was hooked. The same holds for Mr. Butterick. I wonder how you can write so much text with such high quality …)</p>
<p>Anyway, I have been able to come up in around one hour with a simple program that produces an infinite lazy list (called “stream” in Racket), consumes it as long as a certain condition holds, then applies a function to all its elements.</p>
<div class="sourceCode"><pre class="sourceCode scheme"><code class="sourceCode scheme">#lang racket
(require racket/stream)

(<span class="kw">define</span><span class="fu"> </span>(stream-from n s) (stream-cons n (stream-from (<span class="kw">+</span> n s) s)))

(<span class="kw">define</span><span class="fu"> </span>(stream-while s p)
  (<span class="kw">let</span> ([fst (stream-first s)])
  (<span class="kw">if</span> (p fst) (stream-cons fst (stream-while (stream-rest s) p)) empty-stream)))

(<span class="kw">define</span><span class="fu"> test </span>(stream-while (stream-from <span class="dv">0</span> <span class="dv">1</span>) (λ (x) (<span class="kw">&lt;</span> x <span class="dv">100000</span>))))

(stream-for-each println test)</code></pre></div>
<p>This prints all numbers from 0 to 99999. An equivalent Haskell version:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">test <span class="fu">=</span> [<span class="dv">0</span> <span class="fu">..</span>]

main <span class="fu">=</span> mapM_ putStrLn (map show (takeWhile (<span class="fu">&lt;</span> <span class="dv">100000</span>) test))</code></pre></div>
<p>The Haskell version is much smaller, but this can safely be attributed to my being a novice in Racket, having written above program basically directly after having done the obligatory “Hello World”, with the only goal of finding out whether lazy lists are nice to use in Racket. (The answer is a clear “yes”.) On the other hand, when running the two programs with <code>racket</code> and <code>runghc</code> respectively, the Racket version performed better, taking only 0.68s vs 1.28s.</p>
<p>Another quick experiment was to reverse every individual line of a file and to print all resulting lines.</p>
<pre><code>(for-each (compose displayln list-&gt;string reverse string-&gt;list)
  (file-&gt;lines &quot;problems.txt&quot;))</code></pre>
<p>The version above has the disadvantage that it first has to read in the whole file, and only then starts processing it. We can do better using “sequences”, which allow us to iterate over specific parts of an input, for example the lines of a file. The following code was created in roughly 30 minutes and required understanding Racket’s “ports” and “sequences”, both which were relatively easy to grasp given the – I reiterate – excellent documentation:</p>
<pre><code>(call-with-input-file &quot;problems.txt&quot; (lambda (in)
  (sequence-for-each (compose displayln list-&gt;string reverse string-&gt;list)
    (in-lines in))))</code></pre>
<p>As before, the Haskell version is a bit smaller, mostly because strings are lists in Haskell. (This characteristic bites in other places.) Furthermore, this example uses lazy I/O, which can cause surprises and is therefore commonly discouraged in favour of streaming libraries.</p>
<pre><code>readFile &quot;input.txt&quot; &gt;&gt;= mapM_ putStrLn . map reverse . lines</code></pre>
<p>In conclusion, I have really enjoyed learning the concepts of Racket, and I was very astonished to see that so far, the lack of types (which I would have considered an absolute no-go still one week ago) has been much less of a problem than I thought.</p>
<p>The Racket community seems small, but extremely motivated, leading me to believe that this language will gain momentum.</p>

    </div>

    <div id="footer">
      Post: (λ name domain. name@domain) "michael.faerber" "gedenkt.at"
    </div>
  </body>
</html>

<script async type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
