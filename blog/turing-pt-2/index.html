<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Running Turing machines in Haskell, pt. 2 - gedenkt.at</title>

    <link rel="icon" type="image/png" href="../../media/gedenkt_small.png">
    <link rel="stylesheet" type="text/css" href="../../css/default.css">
    <link rel="stylesheet" type="text/css" href="../../css/syntax.css">
  </head>
  <body>
    <div id="header">
      <div id="logo">
        <a href="../../"><img src="../../media/gedenkt_small.png" /></a>
      </div>
      <div id="navigation">
        <a href="../../">Initium</a>
        <a href="../../erasmus">Erasmus</a>
        <a href="../../musica">Musica</a>
        <a href="../../blog">Blog</a>
      </div>
    </div>

    <div id="content">
      <h1>Running Turing machines in Haskell, pt. 2</h1>

      <img src="../../media/gedenkt.png" style="float: right; margin: 10px;" />

<div class="info">
    Geschrieben am 04. Feber 2016
    
</div>

<p>Some days ago, I was challenged to make a smaller version of my <a href="../../blog/turinghaskell.html">Turing machine simulator in Haskell</a>, which I did:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">hdTl [] <span class="fu">=</span> (<span class="dt">Nothing</span>, [])
hdTl (x<span class="fu">:</span>xs) <span class="fu">=</span> (<span class="dt">Just</span> x, xs)

trans f (s, (l, c, r)) <span class="fu">=</span>
  either (\ s' <span class="ot">-&gt;</span> <span class="kw">let</span> (h, t) <span class="fu">=</span> hdTl l <span class="kw">in</span> (s', (t, h, c'<span class="fu">:</span>r)))
         (\ s' <span class="ot">-&gt;</span> <span class="kw">let</span> (h, t) <span class="fu">=</span> hdTl r <span class="kw">in</span> (s', (c'<span class="fu">:</span>l, h, t))) m
  <span class="kw">where</span> (c', m) <span class="fu">=</span> f c s

run f s <span class="fu">=</span> takeWhile ((<span class="ot">`notElem`</span> s) <span class="fu">.</span> fst) <span class="fu">.</span> iterate (trans f)</code></pre></div>
<p>This version is a bit more limited, featuring only automatically generated output for machine runs, but otherwise works similarly.</p>
<p>You can run a machine as follows:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">-- | Duplicate all &quot;ones&quot; on the band</span>
d <span class="dv">0</span> (<span class="dt">Just</span> <span class="ch">'1'</span>) <span class="fu">=</span> (<span class="ch">'1'</span>, <span class="dt">Right</span> <span class="dv">0</span>)
d <span class="dv">0</span> <span class="dt">Nothing</span>    <span class="fu">=</span> (<span class="ch">'!'</span>, <span class="dt">Left</span> <span class="dv">1</span>)
d <span class="dv">1</span> (<span class="dt">Just</span> <span class="ch">'1'</span>) <span class="fu">=</span> (<span class="ch">'!'</span>, <span class="dt">Right</span> <span class="dv">2</span>)
d <span class="dv">1</span> <span class="dt">Nothing</span>    <span class="fu">=</span> (<span class="ch">'!'</span>, <span class="dt">Right</span> <span class="dv">4</span>)
d <span class="dv">2</span> (<span class="dt">Just</span> <span class="ch">'1'</span>) <span class="fu">=</span> (<span class="ch">'1'</span>, <span class="dt">Right</span> <span class="dv">2</span>)
d <span class="dv">2</span> (<span class="dt">Just</span> <span class="ch">'!'</span>) <span class="fu">=</span> (<span class="ch">'1'</span>, <span class="dt">Left</span> <span class="dv">3</span>)
d <span class="dv">2</span> <span class="dt">Nothing</span>    <span class="fu">=</span> (<span class="ch">'1'</span>, <span class="dt">Left</span> <span class="dv">3</span>)
d <span class="dv">3</span> (<span class="dt">Just</span> <span class="ch">'1'</span>) <span class="fu">=</span> (<span class="ch">'1'</span>, <span class="dt">Left</span> <span class="dv">3</span>)
d <span class="dv">3</span> (<span class="dt">Just</span> <span class="ch">'!'</span>) <span class="fu">=</span> (<span class="ch">'1'</span>, <span class="dt">Left</span> <span class="dv">1</span>)

main <span class="fu">=</span> mapM print <span class="fu">$</span> run d [<span class="dv">4</span>] (<span class="dv">0</span>, ([], <span class="dt">Just</span> <span class="ch">'1'</span>, <span class="st">&quot;11&quot;</span>))</code></pre></div>
<p>In the last line, the <code>[4]</code> means that state 4 is the only accepting state. The initial state of the band is “” (empty) to the left, a ‘1’ under the tape head and “11” to the right of the tape head. The output of the program is below:<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<pre><code>(0,(&quot;&quot;,Just '1',&quot;11&quot;))
(0,(&quot;1&quot;,Just '1',&quot;1&quot;))
(0,(&quot;11&quot;,Just '1',&quot;&quot;))
(0,(&quot;111&quot;,Nothing,&quot;&quot;))
(1,(&quot;11&quot;,Just '1',&quot;!&quot;))
(2,(&quot;!11&quot;,Just '!',&quot;&quot;))
(3,(&quot;11&quot;,Just '!',&quot;1&quot;))
(1,(&quot;1&quot;,Just '1',&quot;11&quot;))
(2,(&quot;!1&quot;,Just '1',&quot;1&quot;))
(2,(&quot;1!1&quot;,Just '1',&quot;&quot;))
(2,(&quot;11!1&quot;,Nothing,&quot;&quot;))
(3,(&quot;1!1&quot;,Just '1',&quot;1&quot;))
(3,(&quot;!1&quot;,Just '1',&quot;11&quot;))
(3,(&quot;1&quot;,Just '!',&quot;111&quot;))
(1,(&quot;&quot;,Just '1',&quot;1111&quot;))
(2,(&quot;!&quot;,Just '1',&quot;111&quot;))
(2,(&quot;1!&quot;,Just '1',&quot;11&quot;))
(2,(&quot;11!&quot;,Just '1',&quot;1&quot;))
(2,(&quot;111!&quot;,Just '1',&quot;&quot;))
(2,(&quot;1111!&quot;,Nothing,&quot;&quot;))
(3,(&quot;111!&quot;,Just '1',&quot;1&quot;))
(3,(&quot;11!&quot;,Just '1',&quot;11&quot;))
(3,(&quot;1!&quot;,Just '1',&quot;111&quot;))
(3,(&quot;!&quot;,Just '1',&quot;1111&quot;))
(3,(&quot;&quot;,Just '!',&quot;11111&quot;))
(1,(&quot;&quot;,Nothing,&quot;111111&quot;))</code></pre>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Note that the tape to the left of the tape head looks reversed, as it is “seen” from the tape head.<a href="#fnref1">↩</a></p></li>
</ol>
</div>

    </div>

    <div id="footer">
      Post: (λ name domain. name@domain) "michael.faerber" "gedenkt.at"
    </div>
  </body>
</html>

<script async type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
